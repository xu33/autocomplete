var AutoComplete=function(t){function n(i){if(e[i])return e[i].exports;var s=e[i]={exports:{},id:i,loaded:!1};return t[i].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}var e={};return n.m=t,n.c=e,n.p="",n(0)}([function(module,exports,__webpack_require__){eval("'use strict';\n\nvar $ = __webpack_require__(1);\nvar ejs = __webpack_require__(2);\nvar DEFULAT_TEMPLATE = '<ul>\\n\\t<% for (var i = 0; i < items.length; i++) { %>\\n\\t\\t<li data-index=\"<%=i%>\" class=\"<%=index == i ? \\'active\\' : \\'\\'%>\"><%=items[i]%></li>\\n\\t<%}%>\\n</ul>';\n\nvar AutoComplete = function AutoComplete(el, options) {\n\tif (!options.template) {\n\t\toptions.template = DEFULAT_TEMPLATE;\n\t}\n\n\tthis.index = -1;\n\tthis.el = el;\n\tthis.options = $.extend({}, options);\n\n\tthis._handleDocumentKeyup = this.handleDocumentKeyup.bind(this);\n\tthis._clear = this.clear.bind(this);\n\tthis.init();\n};\n\nAutoComplete.prototype = {\n\tinit: function init() {\n\t\tvar _this = this;\n\n\t\tthis.el.on('input', function (e) {\n\t\t\tvar value = e.target.value;\n\n\t\t\tif (value === '') {\n\t\t\t\t_this.clear();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t$.ajax({\n\t\t\t\turl: _this.options.url + value,\n\t\t\t\tcache: false\n\t\t\t}).done(function (response) {\n\t\t\t\t_this.showResult(response);\n\t\t\t});\n\t\t});\n\t},\n\tclear: function clear() {\n\t\tif (this.resultWrap) {\n\t\t\tthis.resultWrap.hide().html('').off('mouseover').remove();\n\t\t\tthis.resultWrap = null;\n\t\t}\n\n\t\t$(document).unbind('keyup', this._handleDocumentKeyup);\n\t\t$(document).unbind('click', this._clear);\n\t},\n\tshowResult: function showResult(items) {\n\t\tvar _this2 = this;\n\n\t\tthis.index = -1;\n\t\tthis.items = items;\n\n\t\tif (!this.resultWrap) {\n\t\t\tconsole.log('enter here');\n\n\t\t\tvar offset = this.el.offset();\n\t\t\tvar wrap = $('<div>').css({\n\t\t\t\tposition: 'absolute',\n\t\t\t\tleft: offset.left - 1, // 减去border宽度\n\t\t\t\ttop: offset.top + this.el.outerHeight(),\n\t\t\t\tdisplay: 'none'\n\t\t\t});\n\n\t\t\tif (this.options.wrapClass) {\n\t\t\t\twrap.addClass(this.options.wrapClass);\n\t\t\t}\n\n\t\t\t$(document.body).append(wrap);\n\n\t\t\tthis.resultWrap = wrap;\n\n\t\t\tthis.resultWrap.on('mouseenter', 'li', function (e) {\n\t\t\t\tvar index = $(e.currentTarget).data('index');\n\t\t\t\tif (index !== _this2.index) {\n\t\t\t\t\t_this2.index = index;\n\t\t\t\t\t_this2.updateHtml();\n\t\t\t\t}\n\t\t\t}).on('click', 'li', function (e) {\n\t\t\t\t_this2.index = $(e.currentTarget).data('index');\n\t\t\t\t_this2.options.onselect(_this2.items[_this2.index]);\n\t\t\t});\n\n\t\t\t$(document).bind('keyup', this._handleDocumentKeyup);\n\t\t\t$(document).bind('click', this._clear);\n\t\t}\n\n\t\tthis.updateHtml();\n\t\tthis.resultWrap.css('display', '');\n\t},\n\tupdateHtml: function updateHtml() {\n\t\tthis.resultWrap.html(ejs.render(this.options.template, {\n\t\t\titems: this.items,\n\t\t\tindex: this.index\n\t\t}, {\n\t\t\tdelimiter: this.options.ejs.delimiter || '%'\n\t\t}));\n\t},\n\thandleDocumentKeyup: function handleDocumentKeyup(e) {\n\t\tswitch (e.keyCode) {\n\t\t\tcase 40:\n\t\t\t\t// down\n\t\t\t\tthis.index++;\n\t\t\t\tif (this.index >= this.items.length) {\n\t\t\t\t\tthis.index = 0;\n\t\t\t\t} else if (this.index < 0) {\n\t\t\t\t\tthis.index = this.items.length - 1;\n\t\t\t\t}\n\n\t\t\t\tthis.updateHtml();\n\t\t\t\tbreak;\n\t\t\tcase 38:\n\t\t\t\t// up\n\t\t\t\tthis.index--;\n\t\t\t\tif (this.index >= this.items.length) {\n\t\t\t\t\tthis.index = 0;\n\t\t\t\t} else if (this.index < 0) {\n\t\t\t\t\tthis.index = this.items.length - 1;\n\t\t\t\t}\n\t\t\t\tthis.updateHtml();\n\t\t\t\tbreak;\n\t\t\tcase 13:\n\t\t\t\tif (this.index > -1 && this.index < this.items.length) {\n\t\t\t\t\tthis.options.onselect(this.items[this.index]);\n\t\t\t\t}\n\t\t}\n\t}\n};\n\nmodule.exports = AutoComplete;\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/AutoComplete.js\n// module id = 0\n// module chunks = 0\n//# sourceURL=webpack:///./src/AutoComplete.js?")},function(module,exports){eval('module.exports = window.$;\n\n//////////////////\n// WEBPACK FOOTER\n// external "window.$"\n// module id = 1\n// module chunks = 0\n//# sourceURL=webpack:///external_%22window.$%22?')},function(module,exports){eval('module.exports = window.ejs;\n\n//////////////////\n// WEBPACK FOOTER\n// external "window.ejs"\n// module id = 2\n// module chunks = 0\n//# sourceURL=webpack:///external_%22window.ejs%22?')}]);